{"disqus":{"path":"/posts/2008-09-12-downloading-stock-prices-in-f-part-iii-async-loader-for-prices-and-divs/","commentCount":10,"comments":[{"postId":"4303143646","parentPostId":null,"date":"2008-09-12T16:25:24Z","author":"Luca Bolognese's WebLog : Down","avatar":"","message":"<p>PingBack from <a href=\"http://blogs.msdn.com/lucabol/archive/2008/09/05/downloading-stock-prices-in-f-part-ii-html-scraping.aspx\" rel=\"nofollow noopener\" title=\"http://blogs.msdn.com/lucabol/archive/2008/09/05/downloading-stock-prices-in-f-part-ii-html-scraping.aspx\">http://blogs.msdn.com/lucabol/archive/2008/09/05/downloading-stock-prices-in-f-part-ii-html-scraping.aspx</a></p>","replies":[]},{"postId":"4303143655","parentPostId":null,"date":"2008-09-13T11:36:17Z","author":"Keith","avatar":"","message":"<p>Nice article.  One potential improvement: why not use sprintf to avoid all those annoying ToString()s in the commonUrl function?</p>","replies":[]},{"postId":"4303143656","parentPostId":null,"date":"2008-09-15T11:59:14Z","author":"Luca Bolognese","avatar":"","message":"<p>You are so very right. My excuse is that the code for URL func is cut and paste of an old C# code I have. That is not even an excuse given that you can do much better in C# as well :)</p>","replies":[]},{"postId":"4303143647","parentPostId":null,"date":"2008-09-19T17:59:39Z","author":"Luca Bolognese's WebLog","avatar":"","message":"<p>Other parts: Part I - Data modeling Part II - Html scraping Part III - Async loader for prices and divs</p>","replies":[]},{"postId":"4303143651","parentPostId":null,"date":"2008-09-24T07:02:18Z","author":"Carl","avatar":"","message":"<p>Very nice!  I am learning a lot, please keep it up.<br>For better readability, I wrote your url functions as follows:<br>let commonHttpQuery ticker span =<br>  let query = new StringBuilder();<br>  Printf.bprintf query \"s=\"<br>  Printf.bprintf query \"%s\" ticker<br>  Printf.bprintf query \"&amp;a=\"<br>  Printf.bprintf query \"%d\" (span.Start.Month - 1)<br>  Printf.bprintf query \"&amp;b=\"<br>  Printf.bprintf query \"%d\" span.Start.Day<br>  Printf.bprintf query \"&amp;c=\"<br>  Printf.bprintf query \"%d\" span.Start.Year<br>  Printf.bprintf query \"&amp;d=\"<br>  Printf.bprintf query \"%d\" (span.End.Month - 1)<br>  Printf.bprintf query \"&amp;e=\"<br>  Printf.bprintf query \"%d\" span.End.Day<br>  Printf.bprintf query \"&amp;f=\"<br>  Printf.bprintf query \"%d\" span.End.Year<br>  query.ToString()<br>This allows the same query to be used in commonUrl and splitUrl:<br>let commonUrl ticker span =<br>  let urlString query =<br>    let urlBuilder = new UriBuilder()<br>    urlBuilder.Scheme &lt;- \"http\";<br>    urlBuilder.Host &lt;- \"<a href=\"http://ichart.finance.yahoo.com\" rel=\"nofollow noopener\" title=\"ichart.finance.yahoo.com\">ichart.finance.yahoo.com</a>\"<br>    urlBuilder.Port &lt;- 80<br>    urlBuilder.Path &lt;- \"table.csv\"<br>    urlBuilder.Query &lt;- query<br>    urlBuilder.ToString();<br>  urlString (commonHttpQuery ticker span)<br>let splitUrl ticker span page =<br>  let urlString query =<br>    let urlBuilder = new UriBuilder()<br>    urlBuilder.Scheme &lt;- \"http\";<br>    urlBuilder.Host &lt;- \"<a href=\"http://finance.yahoo.com\" rel=\"nofollow noopener\" title=\"finance.yahoo.com\">finance.yahoo.com</a>\"<br>    urlBuilder.Port &lt;- 80<br>    urlBuilder.Path &lt;- \"q/hp\"<br>    urlBuilder.Query &lt;- query<br>    urlBuilder.ToString();<br>  urlString (commonHttpQuery ticker span) + sprintf \"&amp;g=v&amp;z=66&amp;y=%d\" (66 * page)</p>","replies":[]},{"postId":"4303143653","parentPostId":null,"date":"2008-09-24T11:32:39Z","author":"lucabol","avatar":"","message":"<p>Nice, thanks. I didn't even know urlbuilder existed.</p>","replies":[]},{"postId":"4303143665","parentPostId":null,"date":"2008-09-26T16:04:19Z","author":"Luca Bolognese's WebLog","avatar":"","message":"<p>Other parts: Part I - Data modeling Part II - Html scraping Part III - Async loader for prices and divs</p>","replies":[]},{"postId":"4303143668","parentPostId":null,"date":"2008-09-30T11:57:45Z","author":"JohnG","avatar":"","message":"<p>Error1The field, constructor or member 'AsyncGetResponse' is not defined. ???</p>","replies":[]},{"postId":"4303143675","parentPostId":null,"date":"2008-09-30T12:21:54Z","author":"lucabol","avatar":"","message":"<p>You have to reference the FSharp Powerpack. I'm not posting the code yet because I'm working on the UI and want to post everything together.</p>","replies":[]},{"postId":"4303143678","parentPostId":null,"date":"2008-10-20T18:45:52Z","author":"Luca Bolognese's WebLog","avatar":"","message":"<p>Other parts: Part I - Data modeling Part II - Html scraping Part III - Async loader for prices and divs</p>","replies":[]}]}}